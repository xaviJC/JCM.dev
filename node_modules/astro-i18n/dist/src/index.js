var Hn=Object.defineProperty;var Xn=(e,t,r)=>t in e?Hn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var de=(e,t,r)=>(Xn(e,typeof t!="symbol"?t+"":t,r),r),ye=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var l=(e,t,r)=>(ye(e,t,"read from private field"),r?r.call(e):t.get(e)),y=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},R=(e,t,r,n)=>(ye(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);var b=(e,t,r)=>(ye(e,t,"access private method"),r);var L="astro-i18n",gr=`${L}.config`,we="github.com/alexandre-fernandez/astro-i18n/issues";var Re=class extends Error{constructor(t){super(t?`${L}: Unreachable code executed (at "${t}"), please open an issue at "${we}".`:`${L}: Unreachable code executed, please open an issue at "${we}".`)}},hr=Re;function m(){throw new hr}function dr(e=new Error("Something went wrong.")){throw e}var Dt,yr,ut=class{constructor(t){y(this,Dt);de(this,"regexp");this.regexp=new RegExp(t.source,t.flags)}static fromString(t,r){return new ut(new RegExp(t,r))}get source(){return this.regexp.source}get flags(){return this.regexp.flags}add(t){return this.regexp=new RegExp(`${this.regexp.source}${t.source}`,this.regexp.flags),this}test(t){return this.regexp.test(t)}exec(t,r){let n=b(this,Dt,yr).call(this,t),s=n.next();for(;!s.done&&r(s.value)!==ut.BREAK;)s=n.next();return this}match(t){let r=null;return this.exec(t,n=>(r=n,ut.BREAK)),r}clone(){return new ut(new RegExp(this.regexp.source,this.regexp.flags))}toMatcher(){return this.match.bind(this)}},Mt=ut;Dt=new WeakSet,yr=function*(t){let r=this.regexp;r.flags.includes("g")||(r=new RegExp(this.regexp.source,`${this.regexp.flags}g`));let n=r.exec(t);for(;n!==null;)n&&(yield{range:[n.index,n.index+n[0].length],match:[...n]}),n=r.exec(t)},de(Mt,"BREAK","break");var u=Mt;var bt=class{#e;#t;constructor({source:t,flags:r}){this.#e=t,this.#t=r}static fromRegex(t){return new bt(t.regexp)}appendPattern(t){return this.#e=`${this.#e}${t}`,this}matchTrimifiable(){return this.#e=`\\s*${this.#e}\\s*`,this}assertStarting(){return this.#e=`^${this.#e}`,this}assertEnding(){return this.#e=`${this.#e}$`,this}addGroup(){return this.#e=`(${this.#e})`,this}addGlobalFlag(){return this.#t.includes("g")||(this.#t=`${this.#t}g`),this}build(){return new u(new RegExp(this.#e,this.#t))}},N=bt;function z(e,t,r){if(!t(e)){let n="";throw e?typeof e=="object"?n=`
${e.constructor.name}
${JSON.stringify(e,null,4)}`:typeof e=="symbol"?n=`Symbol("${e.description}")`:n=typeof e=="string"?`"${e}"`:`${e}`:n=`${e}`,!r&&t.name.startsWith("is")&&(r=t.name.slice(2)),new TypeError(r?`Unexpected type (expecting \`${r}\`), found: ${n}`:`Unexpected type, found: ${n}`)}}function wr(e){return typeof e=="number"&&!Number.isNaN(e)}function Rr(e){return e instanceof Date&&!Number.isNaN(e.getTime())}function rt(e){return Array.isArray(e)}function Y(e){return rt(e)&&e.every(t=>typeof t=="string")}function p(e){return!!e&&typeof e=="object"}function xe(e){return p(e)?Object.getPrototypeOf(e)===Object.prototype:!1}var pt,nt,At,Tt=class{static get path(){return b(this,nt,At).call(this,"path")}static get posix(){return this.path.then(({posix:t})=>t)}static get fs(){return b(this,nt,At).call(this,"fs")}static get url(){return b(this,nt,At).call(this,"url")}static get module(){return b(this,nt,At).call(this,"module")}};pt=new WeakMap,nt=new WeakSet,At=async function(t){if(l(this,pt)[t])return l(this,pt)[t];let r=await import(`node:${t}`);return l(this,pt)[t]=r,r},y(Tt,nt),y(Tt,pt,{});var A=Tt;async function mt(e){let{sep:t,posix:r}=await A.path;return e.split(t).join(r.sep)}async function st(e){let t=await Zn(e),r=e.split(t);return r.pop(),r.join(t)}function xr(e){switch(e){case"":return!0;case"/":return!0;case"\\":return!0;default:return!/[/\\]/.test(e)}}async function Zn(e){let{sep:t}=await A.path,r=e.split("/").length-1,n=e.split("\\").length-1;return r>n?"/":n>r?"\\":t}function I(e,t,r){let{mode:n,mutable:s}={mode:"replace",mutable:!0,...r},i=s?e:structuredClone(e);for(let[o,c]of Object.entries(t)){let a=i[o];if(Object.hasOwn(i,o)){be(a)&&be(c)?I(a,c):n==="replace"&&(i[o]=t[o]);continue}i[o]=t[o]}return s?void 0:i}function H(e,t,r){let n=typeof t=="string"?[t]:t,s=e;for(let[i,o]of n.entries()){if(i===n.length-1){s[o]=r;break}be(s[o])||(s[o]={}),s=s[o]}}function be(e){return typeof e!="object"?!1:Object.getPrototypeOf(e)===Object.prototype}var Te=class extends Error{constructor(t){super(t?`Peer dependency \`${t}\` was not found, if it's not already done try installing it.`:"A dependency was not found.")}},br=Te;var Ae=class extends Error{constructor(t){super(t?`No file was found for the given path (${t}).`:"No file was found for the given path.")}},Pe=Ae;var Ee=class extends Error{constructor(t=[]){super(t.length>0?`Invalid file type, supported formats are: "${t.join('", "')}"`:"Invalid file type, format not supported.")}},Se=Ee;var Oe=class extends Error{constructor(t){super(t?`Invalid format, could not parse JSON (${t}).`:"Invalid format, could not parse JSON.")}},Tr=Oe;async function V(e){if(!e)return!1;let{existsSync:t,lstatSync:r}=await A.fs;return t(e)&&r(e).isDirectory()}async function gt(e){if(!e)return!1;let{existsSync:t,lstatSync:r}=await A.fs;return t(e)&&!r(e).isDirectory()}async function Ar(e){let{accessSync:t,constants:r}=await A.fs;try{return t(e,r.R_OK),!0}catch{return!1}}async function Ne(e,t){let{readdirSync:r}=await A.fs,n=r(e);await t(await mt(e),n);for(let s of n){let i=`${e}/${s}`;await V(i)&&await Ne(i,t)}}async function Pr(e){let t=null;t=await import("esbuild");let r=/\.(js|cjs|mjs|ts)$/;if(!gt(e))throw new Pe(e);if(!r.test(e))throw new Se(["js","cjs","mjs","ts"]);try{let{outputFiles:n}=await t.build({entryPoints:[e],bundle:!0,external:["esbuild"],format:"cjs",platform:"node",write:!1}),s=new TextDecoder().decode(n[0]?.contents);return s?Qn(s,e.replace(r,".cjs")):{}}catch{throw new br("esbuild")}}async function X(e){if(!gt(e))throw new Pe(e);if(!/\.json$/.test(e))throw new Se(["json"]);let{readFileSync:t}=await A.fs,r=t(e,{encoding:"utf8"});try{return JSON.parse(r)}catch{throw new Tr(e)}}async function Qn(e,t){let{Module:r}=await A.module,n=t.split("/").slice(0,-1).join("/"),s={module:new r(t),require(i){return this.module.require(i)}};return s.module.paths=r._nodeModulePaths(n),s.module.filename=t,s.module.exports={},s.require=i=>s.module.require(i),Object.assign(s.require,{resolve:i=>r._resolveFilename(i,s.module)}),new Function("exports","require","module","__filename","__dirname",e)(s.module.exports,s.require,s.module,t,n),s.module.exports}var $="break",Er=["json","js","cjs","mjs","ts"],Pt="i18n",Z="pages";var _e=class extends Error{constructor(){super(`Could not find astro "${Z}" directory.`)}},Sr=_e;var Or=new u(/(\/[^\s/]+)?(\/[^\s/]+)\.astro$/),Ft=new u(/^---\n([\S\s]+)\n---\n/),Nr=new u(/export\s*(?:const\s+prerender|var\s+prerender|let\s+prerender|prerender)(?:\s*=\s*)?(true|false)?|export\s*?{\s*?prerender\s*?}/),_r=new u(/export\s+(?:async\s+)?(?:function\s+|const\s+|var\s+|let\s+)getStaticPaths|export\s*{\s*getStaticPaths\s*}/);var Le=class{#e;#t;#r;#a;#c;#o=void 0;#n=void 0;#s=null;#i=null;constructor({name:t,route:r,path:n,translations:s,routes:i}){this.#e=t,this.#t=r,this.#r=n,this.#a=s,this.#c=i}get name(){return this.#e}get route(){return this.#t}get path(){return this.#r}get translations(){return this.#a}get routes(){return this.#c}async getContent(){if(this.#s)return this.#s;let{readFileSync:t}=await A.fs;return this.#s=t(this.#r,{encoding:"utf8"}),this.#i=Ft.match(this.#s)?.match[0]||null,this.#s}async getFrontmatter(){return this.#i?this.#i:(this.getContent(),this.#i)}async hasGetStaticPaths(){if(typeof this.#o<"u")return this.#o;let{readFileSync:t}=await A.fs,r=t(this.#r,{encoding:"utf8"}),n=Ft.match(r)?.match[0];return this.#o=n?_r.test(n):!1,this.#o}async prerender(){if(typeof this.#n<"u")return this.#n;let{readFileSync:t}=await A.fs,r=t(this.#r,{encoding:"utf8"}),n=Ft.match(r)?.match[0];if(!n)return this.#n=!1,this.#n;let{match:s}=Nr.match(n)||{};return s?s[1]?this.#n=s[1]==="true":this.#n=!0:this.#n=null,this.#n}async getProxy(t,r){let n=this.path.lastIndexOf("src/pages");if(n=n<0?null:n+9,!n)return null;let s="";t=t.replace(/\/$/,"")||"/";let i=this.#r.slice(n),o=t.split("/").length-1,c=`${"../".repeat(o)}${i.slice(1)}`;if(s+=`---
import Page from "${c}"
`,await this.hasGetStaticPaths()){let{locale:f,route:h}=r.internals.splitLocaleAndRoute(t);s+=`import { getStaticPaths as proxyGetStaticPaths } from "${c}"
/* @ts-ignore */
export const getStaticPaths = (props) => proxyGetStaticPaths({ ...props, astroI18n: `,s+=`{ locale: "${f}", route: "${h}", primaryLocale: "${r.primaryLocale}", secondaryLocales: ["${r.secondaryLocales.join('", "')}"] } })
`}let a=await this.prerender();return typeof a=="boolean"&&(s+=a?`export const prerender = true
`:`export const prerender = false
`),s+=`const { props } = Astro
---
<Page {...props} />`,s}},Ce=Le;var ke=class extends Error{constructor(t){super(t?`Invalid pattern (${t.source}) given, the pattern should match the route name at index 1 (optional), the route locale at index 2 and the translated name at index 3 (optional).`:"Invalid pattern given, the pattern should match the route name at index 1 (optional), the route locale at index 2 and the translated name at index 3 (optional).")}},Lr=ke;function G(e,t=!0){if(t){if(!p(e))return!1;for(let r of Object.values(e))if(!G(r,!1))return!1;return!0}if(typeof e=="string")return!0;if(!p(e))return!1;for(let r of Object.values(e))if(!G(r,!1))return!1;return!0}async function kr(e,t={}){let{join:r}=await A.path,n=`${e}/${t.srcDir}/${Z}`;if(!await V(n))throw new Sr;let s={},i=(t.secondaryLocales||[]).map(w=>`/${t.srcDir}/${Z}/${w}`),o={i18n:Pt,pages:Pt,...t.translationDirectory},c=[t.primaryLocale||"en",...t.secondaryLocales||[]],a=u.fromString(`(\\/[^\\/\\s]+)?(?:\\/_?${o.pages})?\\/_?(${c.join("|")})(\\.[^\\.\\s]+)?\\.json$`),f=u.fromString(`_?${o.pages}`),h=t.showPrimaryLocale?r(n,t.primaryLocale||"en"):n;await Ne(h,async(w,O)=>{if(!i.some(T=>w.includes(T)))for(let T of O){let P=`${w}/${T}`;if(await V(P))continue;let x=P.replace(n,"");if(x.endsWith(".astro")){let{match:U,range:he}=Or.match(x)||{};if(!U||!U[2]||!he)continue;let q="index",ft="/";if(U[1]?U[2]==="/index"?(q=U[1].replace("/",""),ft=`${x.slice(0,he[0])}/${q}`):(q=U[2].replace("/",""),ft=`${x.slice(0,he[0]+U[1].length)}/${q}`):U[2]!=="/index"&&(q=U[2].replace("/",""),ft=`/${q}`),q.startsWith("_"))continue;s[ft]={...s[ft],name:q,route:ft,path:P};continue}if(!x.endsWith(".json"))continue;let{match:C,range:jt}=a.match(x)||{};if(!C||!jt)continue;let F=`${x.slice(0,jt[0])}${C[1]||"/"}`;f.test(F)&&(F="/");let vt=C[2]||m(),pr=F.split("/").slice(-1).join("")||"index",mr=C[3]?C[3].replace(".",""):null,ge=await X(P);z(ge,G,`${vt}.PageTranslations`),I(ge,s[F]?.translations?.[vt]||{});let qn={...s[F]?.translations,[vt]:ge},Yn=mr?{...s[F]?.routes,[vt]:{[pr]:mr}}:{...s[F]?.routes};s[F]={...s[F],name:pr,route:F,translations:qn,routes:Yn}}});let g=[];for(let w of Object.values(s))!w.path||!w.name||!w.route||g.push({translations:{},routes:{},...w});let d=`${e}/${t.srcDir}/${o.i18n}/${Z}`;if(!await V(d))return g.map(w=>new Ce(w));for(let w of g){let O=`${d}${w.route}`.replace(/\/$/,"");if(!await V(O))continue;let T=await Cr(O,w.name,a);for(let{translations:P,routes:x}of T)I(w.translations,P),I(w.routes,x);if(O=`${O}/${o.pages}`,!!await V(O)){T=await Cr(O,w.name,a);for(let{translations:P,routes:x}of T)I(w.translations,P),I(w.routes,x)}}return g.map(w=>new Ce(w))}async function Cr(e,t,r){let{readdirSync:n}=await A.fs,s=[];for(let i of n(e,{encoding:"utf8"})){let{match:o}=r.match(`/${i}`)||{};if(!o)continue;let c=o[2]||dr(new Lr),a=o[3]?o[3].replace(".",""):null,f=await X(`${e}/${i}`);z(f,G,`${c}.PageTranslations`),s.push({translations:{[c]:f},routes:a?{[c]:{[t]:a}}:{}})}return s}var Ie=class extends Error{constructor(t){super(t?`Unable to find project root. ${t}`:"Unable to find project root.")}},Ir=Ie;var $r=u.fromString(`${L}\\.config\\.(${Er.join("|")})`),jr=u.fromString("astro\\.config\\.(js|cjs|mjs|ts)");var vr=new u(/[/\\]?node_modules/),Mr=new u(/.+?node_modules/),Dr=new u(/(?:package|deno)\.json/),Fr=new u(/package\.json/),Vr=new u(/deno\.jsonc?/),Ur=new u(/deps\.ts/);var Vt=".",B="common";var ts=N.fromRegex($r).assertEnding().build(),zr=N.fromRegex(jr).assertEnding().build();function es(e){return e}function Gr(e){let t={routes:[],extra:[],common:void 0};for(let r of Object.keys(e)){if(r.startsWith("/")){t.routes.push(r);continue}if(r===B){t.common=B;continue}t.extra.push(r)}return t}async function Br(e,t={}){let r=`${e}/${t.srcDir}/${t.translationDirectory?.i18n||Pt}`,n={};if(!await V(r))return n;let{readdirSync:s}=await A.fs,i=[t.primaryLocale||"en",...t.secondaryLocales||[]],o=u.fromString(`(${i.join("|")})\\.json`);for(let c of s(r)){if(c===Z)continue;let a=`${r}/${c}`;if(await V(a))for(let f of s(a)){let{match:h}=o.match(f)||{};if(!h?.[1])continue;let g=h[1],d=await X(`${a}/${f}`);z(d,G,`${g}.GroupTranslations`),H(n,[c,g],d)}}return n}async function Ut(e){return ht(Wr(e),ts.regexp)}async function Jr(e){let t=await ht(Wr(e),zr.regexp);if(!t)return null;let{readdirSync:r}=await A.fs,n=await st(t),s=r(n),i=s.find(a=>Fr.test(a));if(i){let a=await X(`${n}/${i}`);if(xe(a)&&xe(a.dependencies)&&a.dependencies[L])return n}return s.find(a=>Vr.test(a))||s.find(a=>Ur.test(a))?n:null}async function Kr(e){let{readdirSync:t}=await A.fs;return typeof t(e).find(r=>zr.test(r))=="string"}function Wr(e){let{match:t}=Mr.match(e)||{};return t?t[0]?.replace(vr.regexp,"")||"/":e}async function ht(e,t,r=1,n=!0){let{readdirSync:s}=await A.fs;if(await gt(e))return t.test(e)?e:n?ht(await st(e),t,1,!1):null;if(!await Ar(e)||xr(e))return null;let i=s(e),o=i.find(a=>t.test(a));if(o)return`${e}/${o}`;if(r>0&&!(typeof i.find(f=>Dr.test(f))=="string"))return ht(await st(e),t,1,!1);let c=i.filter(a=>{switch(a){case"node_modules":return!1;case"src":return!1;case"public":return!1;case"dist":return!1;case"build":return!1;default:return!a.startsWith(".")}});for(let a of c){let f=`${e}/${a}`;if(await gt(e))continue;let h=await ht(f,t,-1,!1);if(typeof h=="string")return h}return r>0?ht(await st(e),t,1,!1):null}var $e=class extends Error{constructor(){super(`Unable to find ${gr}.`)}},qr=$e;function Yr(e){if(!p(e))return!1;for(let t of Object.values(e)){if(!p(t))return!1;for(let r of Object.values(t))if(typeof r!="string")return!1}return!0}function Hr(e){if(!p(e))return!1;for(let t of Object.values(e)){if(!p(t))return!1;for(let r of Object.values(t))if(!G(r))return!1}return!0}function Xr(e){if(!rt(e))return!1;for(let t of e){if(!p(t))return!1;let r=Object.entries(t);if(r.length<2)return!1;for(let[n,s]of r)switch(n){case"groups":{if(!Y(s))return!1;break}case"routes":{if(!Y(s))return!1;break}default:return!1}}return!0}function Zr(e){if(!p(e))return!1;for(let[t,r]of Object.entries(e))if(t!=="i18n"&&t!=="pages"||typeof r!="string")return!1;return!0}function Qr(e){if(!p(e))return!1;for(let[t,r]of Object.entries(e))switch(t){case"primaryLocale":{if(typeof r!="string")return!1;break}case"secondaryLocales":{if(!Y(r))return!1;break}case"fallbackLocale":{if(typeof r!="string")return!1;break}case"showPrimaryLocale":{if(typeof r!="boolean")return!1;break}case"trailingSlash":{if(r!=="always"&&r!=="never")return!1;break}case"run":{if(r!=="server"&&r!=="client+server")return!1;break}case"translations":{if(!Hr(r))return!1;break}case"translationLoadingRules":{if(!Xr(r))return!1;break}case"translationDirectory":{if(!Zr(r))return!1;break}case"routes":{if(!Yr(r))return!1;break}case"srcDir":{if(typeof r!="string")return!1;break}default:return!1}return!0}function tn(e){if(!p(e))return!1;for(let[t,r]of Object.entries(e))switch(t){case"primaryLocale":{if(typeof r!="string")return!1;break}case"secondaryLocales":{if(!Y(r))return!1;break}case"showPrimaryLocale":{if(typeof r!="boolean")return!1;break}case"trailingSlash":{if(r!=="always"&&r!=="never")return!1;break}default:return!1}return!0}var je=class extends Error{constructor(t){super(t?`Your primaryLocale ("${t}") cannot be contained in your secondaryLocales array.`:"Your primaryLocale cannot be contained in your secondaryLocales array.")}},en=je;var Et=class{primaryLocale;secondaryLocales;fallbackLocale;showPrimaryLocale;trailingSlash;run;translations;translationLoadingRules;translationDirectory;routes;path;srcDir;constructor({primaryLocale:t,secondaryLocales:r,fallbackLocale:n,showPrimaryLocale:s,trailingSlash:i,run:o,translations:c,translationLoadingRules:a,translationDirectory:f,routes:h,srcDir:g}={},d=""){if(this.primaryLocale=t||"en",this.secondaryLocales=r||[],this.fallbackLocale=n??(t||""),this.showPrimaryLocale=s||!1,this.trailingSlash=i||"never",this.run=o||"client+server",this.translations=c||{},this.translationLoadingRules=a||[],this.translationDirectory=f||{},this.routes=h||{},this.path=d||"",this.srcDir=g||"src",this.secondaryLocales.includes(this.primaryLocale))throw new en(this.primaryLocale)}get pages(){return Object.keys(this.translations).filter(t=>t.startsWith("/"))}static async fromFilesystem(t=null){let{fileURLToPath:r}=await A.url;if(!t){let s="";typeof process<"u"&&(s=process.env.PWD||""),t=await Ut(await mt(s))}if(!t){let s="";typeof process<"u"&&(s=process.cwd()),t=await Ut(await mt(s))}if(!t){let s="";typeof import.meta=="object"&&typeof import.meta.url=="string"?s=r(import.meta.url):typeof __filename=="string"&&(s=__filename),s&&(t=await Ut(await mt(s)))}if(!t)throw new qr;let n=t.endsWith(".json")?await X(t):(await Pr(t)).default;return z(n,Qr,"AstroI18nConfig"),new Et(n,t).loadFilesystemTranslations()}async loadFilesystemTranslations(){if(!this.path)return this;let t=await st(this.path);if(!await Kr(t)){let s=await Jr(this.path);if(!s)throw new Ir;t=s}let r=await kr(t,this);for(let s of r)this.translations[s.route]||(this.translations[s.route]={}),I(this.translations[s.route]||m(),s.translations),this.routes||(this.routes={}),I(this.routes,s.routes);let n=await Br(t,this);return I(this.translations,n),this}toClientSideObject(){return{primaryLocale:this.primaryLocale,secondaryLocales:this.secondaryLocales,showPrimaryLocale:this.showPrimaryLocale,trailingSlash:this.trailingSlash}}toObject(){return{primaryLocale:this.primaryLocale,secondaryLocales:this.secondaryLocales,fallbackLocale:this.fallbackLocale,showPrimaryLocale:this.showPrimaryLocale,trailingSlash:this.trailingSlash,run:this.run,translations:this.translations,translationLoadingRules:this.translationLoadingRules,translationDirectory:this.translationDirectory,routes:this.routes}}toString(){return JSON.stringify(this.toObject(),null,"	")}},dt=Et;var rn=(n=>(n.NONE="none",n.NODE="node",n.BROWSER="browser",n))(rn||{}),ot=rn;var rs=new u(/[$A-Z_a-z]/),zt=N.fromRegex(rs).appendPattern("[\\w$]*").build(),nn=new u(/-?\d+(?:\.\d+)?/),sn=new u(/^\s*$/),ve=new u(/{{(.+)}}/),Gt=new u(/{#(.+?)#}/),on=u.fromString(`\\(\\s*(${zt.source})\\s*\\)`),an=u.fromString(`>\\s*(${zt.source})\\s*(\\()?`),cn=new u(/(?:function)?\s*[\w$]*\s*\(([\S\s]*?)\)\s*(?:=>)?\s*{?([\S\s]*)/);var Me=class extends Error{constructor(t=""){if(t){let n=t.slice(0,20);n.length===20&&(t=`${n.slice(0,20-3)}...`)}super(t?`Cannot parse unknown value (${t}).`:"Cannot parse unknown value")}},Bt=Me;var De=class extends Error{constructor(t=""){super(t?`Cannot procces untrimmed value ("${t}").`:"Cannot procces untrimmed value")}},Jt=De;var Kt=N.fromRegex(nn).assertStarting().build().toMatcher(),Wt=N.fromRegex(zt).assertStarting().build().toMatcher();function ln(e){return sn.test(e)?{range:[0,0],match:[""]}:null}function qt(e){return e.startsWith("undefined")?{range:[0,9],match:["undefined"]}:null}function Yt(e){return e.startsWith("null")?{range:[0,4],match:["null"]}:null}function Ht(e){return e.startsWith("true")?{range:[0,4],match:["true"]}:e.startsWith("false")?{range:[0,5],match:["false"]}:null}function Xt(e){let t=e[0];if(t!=='"'&&t!=="'"&&t!=="`")return null;let r=e.slice(1).indexOf(t);return r===-1?null:(r+=2,{range:[0,r],match:[e.slice(0,r)]})}function fn(e){if(!e.startsWith("{"))return null;let t=0;for(let r=0;r<e.length;r+=1){let n=e[r];if(n==="{"?t+=1:n==="}"&&(t-=1),t===0){let s=r+1;return{range:[0,s],match:[e.slice(0,s)]}}}return null}function Zt(e){if(!e.startsWith("["))return null;let t=0;for(let r=0;r<e.length;r+=1){let n=e[r];if(n==="["?t+=1:n==="]"&&(t-=1),t===0){let s=r+1;return{range:[0,s],match:[e.slice(0,s)]}}}return null}function j(e,t){let r=0,n=!1,s=null;for(let i=0;i<e.length;i+=1){let o=e[i]||m(),c=o==='"'||o==="'"||o==="`",a=!1,f=!1;if(o==="{"||o==="["?(r+=1,a=!0):o==="}"||o==="]"?(r-=1,f=!0):!n&&c?(r+=1,n=!0,s=o,a=!0):n&&o===s&&(r-=1,n=!1,s=null,f=!0),t(o,i,r,a,f)===$)break}}var ns=N.fromRegex(on).assertStarting().build().toMatcher(),ss=N.fromRegex(an).assertStarting().build().toMatcher();function Ve(e){e=e.trim();let t=e,{value:r,type:n,end:s}=os(e);e=e.slice(s).trim();let i=null,o=ns(e);if(o){let{match:a,range:f}=o;i=a[1]||m(),e=e.slice(f[1]).trim()}let c=[];for(;e.length>0;){e[0]===")"&&(e=e.slice(1));let{match:a,range:f}=ss(e)||{};if(!a?.[1]||!f)break;if(e=e.slice(f[1]).trim(),!a[2]){c.push({name:a[1],args:[]});continue}let{args:h,end:g}=is(e);e=e.slice(g).trim(),c.push({name:a[1],args:h})}return{raw:t,value:r,type:n,alias:i,formatters:c}}function it(e){let t=[];e=e.trim();let{type:r,value:n,alias:s,formatters:i}=Ve(e);for(let o of i)for(let c of o.args)for(let a of it(c))t.push(a);switch(r){case 4:{t.push(s||n);break}case 6:{let o="",c=!0;j(e,(a,f,h,g)=>{if(h===0){for(let d of it(o))t.push(d);return $}if(c){if(g&&a==="{"||/\s/.test(a))return null;if(a===":")return c=!1,null}else if(a===","){for(let d of it(o))t.push(d);return o="",c=!0,null}return c||(o+=a),null});break}case 7:{let o="";j(e,(c,a,f,h)=>{if(f===0){for(let g of it(o))t.push(g);return $}if(h&&c==="[")return null;if(c===","){for(let g of it(o))t.push(g);return o="",null}return o+=c,null});break}default:break}return t}function os(e){if(/^\s+\S/.test(e))throw new Jt(e);let t=ln(e);if(t)return{value:"undefined",type:0,end:t.range[1]};if(t=qt(e),t)return{value:t.match[0]||m(),type:0,end:t.range[1]};if(t=Yt(e),t)return{value:t.match[0]||m(),type:1,end:t.range[1]};if(t=Ht(e),t)return{value:t.match[0]||m(),type:2,end:t.range[1]};if(t=Kt(e),t)return{value:t.match[0]||m(),type:3,end:t.range[1]};if(t=Wt(e),t)return{value:t.match[0]||m(),type:4,end:t.range[1]};if(t=Xt(e),t)return{value:t.match[0]||m(),type:5,end:t.range[1]};if(t=fn(e),t)return{value:t.match[0]||m(),type:6,end:t.range[1]};if(t=Zt(e),t)return{value:t.match[0]||m(),type:7,end:t.range[1]};throw new Bt(e)}function is(e){let t={args:[],end:0},r="",n=!1;return j(e,(s,i,o)=>(s==="("&&(n=!0),o>0?(r+=s,null):s===","?(t.args.push(r.trim()),r="",null):s===")"?(n&&(r+=s),t.args.push(r.trim()),t.end=i+1,r="",$):(r+=s,null))),t}function un(e,t,r,n,s,i){let o;switch(r){case 0:{o=void 0;break}case 1:{o=null;break}case 2:{if(e==="true"){o=!0;break}if(e==="false"){o=!1;break}}case 3:{o=e.includes(".")?Number.parseFloat(e):Number.parseInt(e,10);break}case 4:{if(t){o=s[t];break}o=s[e];break}case 5:{o=e.slice(1,-1);break}case 6:{o=as(e,s,i);break}case 7:{o=cs(e,s,i);break}default:throw new Bt(e)}for(let{name:c,args:a}of n){let f=i[c];if(!f)return;let h=a.map(g=>new Q(g,s,i).value);o=f(o,...h)}return o}function as(e,t,r){let n={},s="",i="",o=!0;return j(e,(c,a,f,h)=>{if(f===0)return n[s]=new Q(i,t,r).value,$;if(f===1){if(o){if(h||/\s/.test(c))return null;if(c===":")return o=!1,null;s+=c}else if(c===",")return n[s]=new Q(i,t,r).value,s="",i="",o=!0,null}return o||(i+=c),null}),n}function cs(e,t,r){let n=[],s="";return j(e,(i,o,c,a)=>{if(c===0)return n.push(new Q(s,t,r).value),$;if(c===1){if(a)return null;if(i===",")return n.push(new Q(s,t,r).value),s="",null}return s+=i,null}),n}var Ue=class{raw;value;alias=null;constructor(t,r,n){let{raw:s,value:i,type:o,alias:c,formatters:a}=Ve(t);this.raw=s,this.alias=c,this.value=un(i,c,o,a,r,n)}},Q=Ue;var ze=class extends Error{constructor(t){super(t?`Variant priority must be of type number (found: (${t})).`:"Variant priority must be of type number.")}},pn=ze;var Ge=class extends Error{constructor(t){super(t?`Invalid variant property key (${t}), it must be a valid variable name.`:"Invalid variant property value, it must be a valid variable name.")}},mn=Ge;var gn="undefined, null, number, string, boolean and flat arrays of these types.",Be=class extends Error{constructor(t){super(t?`Invalid variant property value (${t}), accepted types are: ${gn}.`:`Invalid variant property value, accepted types are: ${gn}.`)}},at=Be;function St(e){if(/^\s/.test(e))throw new Jt(e);let t=qt(e);if(t)return{value:t.match[0]||m(),type:0,end:t.range[1]};if(t=Yt(e),t)return{value:t.match[0]||m(),type:1,end:t.range[1]};if(t=Ht(e),t)return{value:t.match[0]||m(),type:2,end:t.range[1]};if(t=Kt(e),t)return{value:t.match[0]||m(),type:3,end:t.range[1]};if(t=Xt(e),t)return{value:t.match[0]||m(),type:5,end:t.range[1]};if(t=Zt(e),t)return{value:t.match[0]||m(),type:7,end:t.range[1]};throw new at(e)}function Je(e){return e===null||typeof e>"u"||typeof e=="boolean"||typeof e=="number"||typeof e=="string"}function hn(e){return Array.isArray(e)?e.every(t=>Je(t)):!1}function Ot(e,t){let r;switch(t){case 0:{r=void 0;break}case 1:{r=null;break}case 2:{if(e==="true"){r=!0;break}if(e==="false"){r=!1;break}}case 3:{r=e.includes(".")?Number.parseFloat(e):Number.parseInt(e,10);break}case 5:{r=e.slice(1,-1);break}case 7:{r=ls(e);break}default:throw new at(e)}return r}function ls(e){let t=[],r="";return j(e,(n,s,i,o)=>{if(i===0){let{value:c,type:a}=St(r.trim()),f=Ot(c,a);if(!Je(f))throw new at(r);return t.push(f),$}if(i===1){if(o)return null;if(n===","){let{value:c,type:a}=St(r.trim());return t.push(Ot(c,a)),r="",null}}return r+=n,null}),t}var dn="$priority";var Nt=class{raw;priority;properties;value;constructor({raw:t,priority:r,properties:n,value:s}={}){this.raw=t||"",this.priority=r||0,this.properties=n||[],this.value=s||""}static fromString(t,r){let n=new Nt;n.value=r;let s=t.trim();n.raw=s;let i="",o="",c=!0;return j(s,(a,f,h)=>{let g=f===s.length-1;if(c)return/\s/.test(a)?null:a===":"?(c=!1,null):(i+=a,null);if(h>0)return o+=a,null;if(g&&(o+=a),a===","||g){let d=Wt(i.trim())?.match[0];if(!d)throw new mn(i);let{value:w,type:O}=St(o.trim());if(d===dn){let x=Ot(w,O);if(typeof x!="number")throw new pn(w);return n.priority=x*.001,null}let T=Ot(w,O),P=Array.isArray(T)?T:[T];if(!hn(P))throw new at(o);return n.properties.push({name:d,values:P}),i="",o="",c=!0,null}return o+=a,null}),n}calculateMatchingScore(t){let r=0;for(let{name:n,values:s}of this.properties){if(!Object.hasOwn(t,n))continue;let i=t[n],o=[];for(let c of s){if(typeof i=="number"&&typeof c=="number"){let a=i-c;if(a===0){o.push(1e3);continue}o.push(Math.abs(1e3/a)-1);continue}i===c&&o.push(1e3)}o.length!==0&&(r+=Math.max(...o))}return r>0?r+this.priority:r}},Qt=Nt;var Ke=class extends Error{constructor(){super("Cannot use a variant on a key which value is not a string.")}},yn=Ke;function We(e,t="",r={}){for(let[n,s]of Object.entries(e)){if(typeof s=="string"){let{match:i,range:o}=ve.match(n)||{};if(!i?.[1]||!o){let a=`${t}${Vt}${n}`.replace(/^\./,"");if(r[a]){r[a].default=s;continue}r[a]={default:s,variants:[]};continue}let c=`${t}${Vt}${n.slice(0,o[0])+n.slice(o[1])}`.replace(/^\./,"");if(r[c]){r[c].variants.push(Qt.fromString(i[1],s));continue}r[c]={variants:[Qt.fromString(i[1],s)]};continue}if(ve.test(n))throw new yn;We(s,`${t}${Vt}${n}`.replace(/^\./,""),r)}return r}function wn(e,t,r){let n=[];Gt.exec(e,({match:i,range:o})=>{if(!i[1])return;let{value:c}=new Q(i[1],t,r);n.push({value:fs(c),range:o})});let s=e;for(let i=n.length-1;i>=0;i-=1){let{value:o,range:c}=n[i]||m();s=s.slice(0,c[0])+o+s.slice(c[1])}return s}function fs(e){switch(typeof e){case"undefined":return"";case"string":return e;case"bigint":return e.toString();case"number":return e.toString();case"boolean":return e.toString();case"symbol":return`Symbol(${e.description})`||"Symbol";case"function":return e.name;case"object":return e?Object.hasOwn(e,"toString")&&typeof e.toString=="function"?e.toString():JSON.stringify(e,null,"	"):"";default:return""}}function Rn(e){for(let t of Object.values(e))for(let r of Object.values(t))for(let n of Object.values(r))n.variants=n.variants.map(s=>new Qt(s));return e}var yt=new u(/\[(\.{3})?([\w-]+)]/),xn=new u(/(?:https?:\/{2})?[\w#%+.:=@~-]{1,256}\.[\d()A-Za-z]{1,6}\b[\w#%&()+./:=?@~-]*/);var _t=class{#e={};#t;constructor(t={},r={}){this.#t=t,this.#e=r}static fromConfig({translations:t,translationLoadingRules:r}){return new _t().addTranslations(t).addTranslationLoadingRules(r)}get(t,r,n,s="",i={},o={},c=!1){let a=this.#r(t,r,n,c);!a&&s&&s!==n&&(a=this.#r(t,r,s,c));let f={score:0,value:a?.default||t};for(let h of a?.variants||[]){let g=h.calculateMatchingScore(i);g>f.score&&(f.score=g,f.value=h.value)}return wn(f.value,i,o)}getRouteGroups(){return Object.keys(this.#t).filter(t=>t.startsWith("/"))}getParamRouteGroups(){return Object.keys(this.#t).filter(t=>t.startsWith("/")&&yt.test(t))}getLocaleTranslationVariables(t){let r={};for(let n of Object.values(this.#t)){if(!n[t])continue;let s=Object.entries(n[t]||m());for(let[i,{default:o,variants:c}]of s){let a={interpolationVars:[],variantVars:[],isVariantRequired:!1},f=[];if(o===void 0?a.isVariantRequired=!0:f.push(o),c.length>0){let T={};for(let{value:P,properties:x}of c){f.push(P);for(let{name:C,values:jt}of x)T[C]=[...T[C]||[],...jt]}a.variantVars=Object.entries(T).map(([P,x])=>({name:P,values:x}))}for(let T of f)Gt.exec(T,({match:P})=>{P[1]&&(a.interpolationVars=[...new Set([...a.interpolationVars,...it(P[1])])])});if(!r[i]){r[i]=a;continue}let{interpolationVars:h,variantVars:g,isVariantRequired:d}=r[i]||{},w=[...new Set([...h||[],...a.interpolationVars])],O=[];for(let T of a.variantVars){let P=g?.find(x=>x.name===T.name);O.push(P?{name:T.name,values:[...new Set([...P?.values||[],...T.values])]}:T)}r[i]={interpolationVars:w,variantVars:O,isVariantRequired:(d||!1)&&a.isVariantRequired}}}return r}addTranslations(t){for(let[r,n]of Object.entries(t)){let s=Object.entries(n);if(s.length===0&&!this.#t[r]){this.#t[r]={};continue}for(let[i,o]of s)H(this.#t,[r,i],We(o))}return this}addTranslationLoadingRules(t){if(t.length===0)return this;let{routes:r}=Gr(this.#t);for(let n of t){let s=[];for(let i of n.groups){let o=u.fromString(i);s.push(...Object.keys(this.#t).filter(c=>o.test(c)))}for(let i of n.routes){let o=u.fromString(i),c=r.filter(a=>o.test(a));for(let a of c){if(!this.#e[a]){this.#e[a]=[...new Set(s)];continue}this.#e[a]=[...new Set([...this.#e[a]||m(),...s])]}}}return this}clear(){this.#e={},this.#t={}}toClientSideObject(t){let r={};if(this.#e[t])for(let n of this.#e[t]||m())r[n]=this.#t[n]||{};return this.#t[t]&&(r[t]=this.#t[t]||{}),this.#t[B]&&(r[B]=this.#t[B]||{}),r}toObject(){return{loadDirectives:this.#e,translations:this.#t}}toString(){return JSON.stringify(this.toObject(),null,"	")}#r(t,r,n,s=!1){let i=null;if(s){let o=this.getRouteGroups();for(let c of o)for(let a of this.#e[c]||[]){let f=this.#t[a]?.[n]?.[t];if(f){i=f;break}}if(!i)for(let c of o)this.#t[c]?.[n]?.[t]&&(i=this.#t[c]?.[n]?.[t]||m())}else{for(let o of this.#e[r]||[]){let c=this.#t[o]?.[n]?.[t];if(c){i=c;break}}!i&&this.#t[r]?.[n]?.[t]&&(i=this.#t[r]?.[n]?.[t]||m())}return!i&&this.#t[B]?.[n]?.[t]&&(i=this.#t[B]?.[n]?.[t]||m()),i}},te=_t;var qe=class extends Error{constructor(t){super(t?`Invalid date (${t}).`:"Invalid date.")}},bn=qe;var Ye=class extends TypeError{constructor(t,r){t?super(r?`Invalid formatter (${r}) parameter: ${t}`:`Invalid formatter parameter: ${t}`):super(r?`Invalid formatter (${r}) parameter.`:"Invalid formatter parameter.")}},wt=Ye;var He=class extends TypeError{constructor(t,r){t?super(r?`Invalid formatter (${r}) value: ${t}`:`Invalid formatter value: ${t}`):super(r?`Invalid formatter (${r}) value.`:"Invalid formatter value.")}},ct=He;function Xe(e){if(typeof e!="string")throw new ct(`Received value is not a string, found "${e}".`,"upper");return e.toUpperCase()}function Ze(e){if(typeof e!="string")throw new ct(`Received value is not a string, found "${e}".`,"lower");return e.toLowerCase()}function Tn(e){if(typeof e!="string")throw new ct(`Received value is not a string, found "${e}".`,"capitalize");return`${e.slice(0,1).toUpperCase()}${e.slice(1).toLowerCase()}`}function An(e,t){return e??t}function Qe(e,t){return e||t}function Pn(e,t){return typeof e=="string"?e:t}function En(e,t=!0){if(typeof e=="symbol")throw new ct(`Received value cannot be a symbol, found "${e.toString()}".`,"json");if(typeof t!="boolean")throw new wt(`format must be a boolean, found "${t}".`,"json");return t?JSON.stringify(e,null,"	"):JSON.stringify(e)}function Sn(e,t={},r=E.locale){if(typeof e=="string"&&(e=Number.parseFloat(e)),!wr(e))throw new ct(`Received value is not a number, found "${e}".`,"intl_format_number");if(!p(t))throw new wt(`options must be an object, found "${t}".`,"intl_format_number");if(typeof r!="string")throw new wt(`locale must be a string, found "${r}".`,"intl_format_number");return new Intl.NumberFormat(r,t).format(e)}function On(e,t={},r=E.locale){if(typeof e!="string"&&typeof e!="number"&&!(e instanceof Date))throw new ct(`Received value is not a string, number or Date, found "${e}".`,"intl_format_date");if(e=e instanceof Date?e:new Date(e),!Rr(e))throw new bn(e);if(!p(t))throw new wt(`options must be an object, found "${t}".`,"intl_format_date");if(typeof r!="string")throw new wt(`locale must be a string, found "${r}".`,"intl_format_date");return new Intl.DateTimeFormat(r,t)}var us=N.fromRegex(cn).assertStarting().assertEnding().build().toMatcher();function Nn(e){let t=us(e.toString());if(!t)return{args:[],body:""};let[,r,n]=t.match;return{args:ps(r||""),body:ms(n||"")}}function _n(e){let t={};for(let[r,n]of Object.entries(e))t[r]=new Function(...n.args,n.body);return t}function ps(e){return e.trim().split(",").map(t=>t.trim())}function ms(e){return e.trim().endsWith("}")?e.slice(0,-1):e}var tr=class{#e={upper:Xe,uppercase:Xe,lower:Ze,lowercase:Ze,capitalize:Tn,json:En,default_nullish:An,default:Qe,default_falsy:Qe,default_non_string:Pn,intl_format_number:Sn,intl_format_date:On};#t;#r;constructor(t={}){this.#t=t,this.#r={...this.#e,...this.#t}}get default(){return this.#e}get custom(){return this.#t}addFormaters(t){for(let[r,n]of Object.entries(t))this.#r[r]||(this.#r[r]=n,this.#t[r]=n);return this}clear(){this.#t={},this.#r={}}toClientSideObject(){let t={};for(let[r,n]of Object.entries(this.#t))t[r]=Nn(n);return t}toObject(){return this.#r}toString(){return JSON.stringify(this.toObject(),null,"	")}},ee=tr;var er=class extends Error{constructor(t){super(t?`Invalid environment: ${t}`:"Invalid environment.")}},Ln=er;var Lt=class{#e;#t;constructor(t={},r=""){this.#t=t,this.#e=r}static fromConfig({routes:t,primaryLocale:r}){return new Lt({},r).addSegments(t)}get(t,r,n){return this.#t[r]?.[t]?.[n]||null}getSegmentLocales(t){let r=[];for(let[n,s]of Object.entries(this.#t))s[t]&&r.push(n);return r}addSegments(t){let r=Object.entries(t);for(let[n,s]of r){let i=r.filter(([o])=>o!==n&&o!==this.#e);for(let[o,c]of Object.entries(s)){H(this.#t,[this.#e,o,n],c),H(this.#t,[n,c,this.#e],o);for(let[a,f]of i)f[o]&&H(this.#t,[n,c,a],f[o])}}return this}clear(){this.#e="",this.#t={}}toClientSideObject(){return{...this.#t}}toObject(){return{primaryLocale:this.#e,segments:this.#t}}toString(){return JSON.stringify(this.toObject(),null,"	")}},re=Lt;var rr=class extends Error{constructor(){super("Cannot initialize astro-i18n, it already has been initialized.")}},Cn=rr;var nr=class extends Error{constructor(t){super(t?`Cannot use filesystem: ${t}`:"Cannot use filesystem.")}},kn=nr;var sr=class extends Error{constructor(){super(`Could not find the serialized ${L} state in the DOM. Check your ${L} config.`)}},In=sr;function $n(e){if(!p(e))return!1;for(let t of Object.values(e)){if(!p(t))return!1;for(let r of Object.values(t)){if(!p(r))return!1;for(let n of Object.values(r))if(typeof n!="string")return!1}}return!0}function jn(e){if(!p(e))return!1;for(let t of Object.values(e)){if(!p(t))return!1;let r=Object.entries(t);if(r.length<2)return!1;for(let[n,s]of r)switch(n){case"args":{if(!Y(s))return!1;break}case"body":{if(typeof s!="string")return!1;break}default:break}}return!0}function vn(e){if(!p(e))return!1;for(let t of Object.values(e)){if(!p(t))return!1;for(let r of Object.values(t))if(!gs(r))return!1}return!0}function gs(e){if(!p(e))return!1;for(let t of Object.values(e)){if(!p(t))return!1;for(let[r,n]of Object.entries(t))switch(r){case"default":{if(typeof n!="string")return!1;break}case"variants":{if(!rt(n)||!n.every(s=>hs(s)))return!1;break}default:return!1}}return!0}function hs(e){if(!p(e))return!1;let t=Object.entries(e);if(t.length<4)return!1;for(let[r,n]of t)switch(r){case"raw":{if(typeof n!="string")return!1;break}case"priority":{if(typeof n!="number")return!1;break}case"properties":{if(!rt(n)||!n.every(s=>ds(s)))return!1;break}case"value":{if(typeof n!="string")return!1;break}default:return!1}return!0}function ds(e){if(!p(e))return!1;let t=Object.entries(e);if(t.length<2)return!1;for(let[r,n]of t)switch(r){case"name":{if(typeof n!="string")return!1;break}case"values":{if(!rt(n)||!n.every(s=>typeof s=="boolean"||typeof s=="string"||typeof s=="number"||s==null))return!1;break}default:return!1}return!0}function Mn(e){if(!p(e))return!1;let t=Object.entries(e);if(t.length<5)return!1;for(let[r,n]of t)switch(r){case"locale":{if(typeof n!="string")return!1;break}case"route":{if(typeof n!="string")return!1;break}case"config":{if(!tn(n))return!1;break}case"translations":{if(!vn(n))return!1;break}case"segments":{if(!$n(n))return!1;break}case"formatters":{if(!jn(n))return!1;break}default:return!1}return!0}function or(e){return xn.test(e)}function Dn(e){let t="",r=0;return yt.exec(e,({match:n,range:[s,i]})=>{if(t+=e.slice(r,s),!n[2]){r=i;return}t+=n[1]?"[\\w/-]+":"[\\w-]+",r=i}),t+=e.slice(r),u.fromString(t.replaceAll("/","\\/"))}var ir=class extends Error{constructor(){super("Cannot perform operation, astro-i18n is not initialized.")}},ar=ir;var cr=class extends Error{constructor(){super("Could not redirect, is this code running in the server ?")}},Fn=cr;var Ct,tt,J,K,S,_,k,v,M,W,et,D,lt,ie,Vn,ae,Un,ce,zn,le,Gn,fe,Bn,Rt,se,kt,lr,It,fr,xt,oe,$t,ur,ue,Jn,pe,Kn,me=class{constructor(){y(this,ie);y(this,ae);y(this,ce);y(this,le);y(this,fe);y(this,Rt);y(this,kt);y(this,It);y(this,xt);y(this,$t);y(this,ue);y(this,pe);y(this,tt,void 0);y(this,J,"");y(this,K,"");y(this,S,new dt);y(this,_,new te);y(this,k,new re);y(this,v,new ee);y(this,M,!1);y(this,W,!1);y(this,et,{});y(this,D,null);y(this,lt,"");typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node<"u"?R(this,tt,ot.NODE):typeof window>"u"?R(this,tt,ot.NONE):(R(this,tt,ot.BROWSER),l(this,S).run==="client+server"&&b(this,ie,Vn).call(this))}get environment(){return l(this,tt).toString()}get route(){return l(this,W)?"":l(this,K)}set route(t){or(t)&&(t=new URL(t).pathname),t=decodeURI(t);let{locale:r,route:n}=b(this,xt,oe).call(this,t);R(this,K,n),R(this,J,r||b(this,It,fr).call(this,b(this,$t,ur).call(this,n))||this.primaryLocale)}get pages(){return l(this,_).getRouteGroups()}get page(){return b(this,Rt,se).call(this,this.route)}get locale(){return l(this,J)}get locales(){return[l(this,S).primaryLocale,...l(this,S).secondaryLocales]}get primaryLocale(){return l(this,S).primaryLocale}get secondaryLocales(){return l(this,S).secondaryLocales}get fallbackLocale(){return l(this,S).fallbackLocale}get isInitialized(){return l(this,M)}get internals(){return{toHtml:b(this,ue,Jn).bind(this),config:l(this,S),segments:l(this,k),translations:l(this,_),splitLocaleAndRoute:b(this,xt,oe).bind(this),toString:b(this,pe,Kn).bind(this),waitInitialization:b(this,ae,Un).bind(this),setPrivateProperties:b(this,fe,Bn).bind(this),reinitalize:b(this,ce,zn).bind(this),getAndClearRedirection:b(this,le,Gn).bind(this)}}t(t,r={},n={}){if(!l(this,M))throw new ar;let{route:s,locale:i,fallbackLocale:o}=n;if(l(this,W))return l(this,_).get(t,"",i||this.locale,o||this.fallbackLocale,r,l(this,v).toObject(),!0);let c=s?b(this,Rt,se).call(this,s):b(this,Rt,se).call(this,this.route);return l(this,_).get(t,c||"",i||this.locale,o||this.fallbackLocale,r,l(this,v).toObject())}l(t,r={},n={}){if(!l(this,M))throw new ar;let{targetLocale:s,routeLocale:i,showPrimaryLocale:o,query:c}=n,a=b(this,$t,ur).call(this,decodeURI(t)),f=this.locales.includes(a[0]||"")&&a.shift()||"",h=i||f||b(this,It,fr).call(this,a)||this.primaryLocale,g=s||this.locale,d=a.map(x=>l(this,k).get(x,h,g)||x).join("/"),w=Object.entries(r);if(w.length>0)for(let[x,C]of w)d=d.replace(`[${x}]`,String(C).replace("/",""));if((o===void 0?l(this,S).showPrimaryLocale||g!==this.primaryLocale:o)&&(d=d?`${g}/${d}`:g),l(this,S).trailingSlash==="always"&&(d+="/"),d=d.startsWith("/")?d:`/${d}`,!c)return d;let T={};for(let[x,C]of Object.entries(c))T[x]=String(C);let P=new URLSearchParams(T).toString();return P?`${d}?${P}`:d}addTranslations(t){return l(this,_).addTranslations(t),b(this,kt,lr).call(this),this}addFormatters(t){return l(this,v).addFormaters(t),this}addTranslationLoadingRules(t){return l(this,_).addTranslationLoadingRules(t),this}addRoutes(t){return l(this,k).addSegments(t),b(this,kt,lr).call(this),this}extractRouteLocale(t){return b(this,xt,oe).call(this,t).locale}redirect(t,r=301){if(this.environment===ot.BROWSER)throw new Fn;if(typeof t=="string"){let n=or(t)?new URL(t):new URL(`${l(this,lt)}/${t.replace(/^\//,"")}`);R(this,D,Response.redirect(n,r));return}R(this,D,Response.redirect(t,r))}async initialize(t=void 0,r={}){if(l(this,M))throw new Cn;switch(l(this,tt)){case ot.NODE:{R(this,S,typeof t=="object"?await new dt(t).loadFilesystemTranslations():await dt.fromFilesystem(t));break}case ot.NONE:{if(typeof t=="string")throw new kn("Cannot load config from filesystem in a non-node environment.");R(this,S,new dt(t||{}));break}default:throw new Ln("Cannot initialize in a browser environment.")}R(this,_,te.fromConfig(l(this,S))),R(this,k,re.fromConfig(l(this,S))),R(this,v,new ee(r)),R(this,M,!0)}},ne=me;Ct=new WeakMap,tt=new WeakMap,J=new WeakMap,K=new WeakMap,S=new WeakMap,_=new WeakMap,k=new WeakMap,v=new WeakMap,M=new WeakMap,W=new WeakMap,et=new WeakMap,D=new WeakMap,lt=new WeakMap,ie=new WeakSet,Vn=function(){let t=document.querySelector(`#${l(me,Ct)}`);if(!t||!t.textContent)throw new In;let r=JSON.parse(t.textContent);z(r,Mn),R(this,J,r.locale),R(this,K,r.route),R(this,S,new dt(r.config)),R(this,_,new te(Rn(r.translations))),R(this,k,new re(r.segments,r.config.primaryLocale)),R(this,v,new ee(_n(r.formatters))),R(this,M,!0),t.remove()},ae=new WeakSet,Un=async function(){let t=r=>{l(this,M)?r():setTimeout(()=>t(r),25)};return new Promise(t)},ce=new WeakSet,zn=async function(t=void 0,r={}){R(this,M,!1),l(this,_).clear(),l(this,k).clear(),l(this,v).clear(),await this.initialize(t,r)},le=new WeakSet,Gn=function(){let t=l(this,D);return R(this,D,null),t},fe=new WeakSet,Bn=function(t={}){let{route:r,locale:n,isGetStaticPaths:s,origin:i}={route:l(this,K),locale:l(this,J),isGetStaticPaths:l(this,W),origin:l(this,lt),...t};R(this,K,r),R(this,J,n),R(this,W,s),R(this,lt,i)},Rt=new WeakSet,se=function(t){if(l(this,W))return null;if(l(this,et)[t])return l(this,et)[t]||m();let r=this.l(t,void 0,{targetLocale:this.primaryLocale});if(this.pages.includes(r))return r;let n=null;for(let s of this.pages)if(yt.test(s)&&Dn(s).test(t)){n=s;break}return!n||!this.pages.includes(n)?null:(l(this,et)[t]=n,n)},kt=new WeakSet,lr=function(){R(this,et,{})},It=new WeakSet,fr=function(t){let r={};for(let s of t)for(let i of l(this,k).getSegmentLocales(s))r[i]||(r[i]=0),r[i]+=1;let n={locale:"",score:0,isExAequo:!0};for(let[s,i]of Object.entries(r)){if(i>n.score){n.locale=s,n.score=i,n.isExAequo=!1;continue}i===n.score&&(n.isExAequo=!0)}return n.isExAequo?null:n.locale||null},xt=new WeakSet,oe=function(t){t.startsWith("/")||(t=`/${t}`);let r=u.fromString(`\\/(${this.locales.join("|")})(?:\\/.*)?$`),{match:n}=r.match(t)||{},s=n?.[1]||null;return{locale:s,route:s?t.replace(`/${s}`,"").replace(/\/$/,"")||"/":t.replace(/\/$/,"")||"/"}},$t=new WeakSet,ur=function(t){return t.replace(/^\//,"").replace(/\/$/,"").split("/")},ue=new WeakSet,Jn=function(){let t={locale:l(this,J),route:l(this,K),config:l(this,S).toClientSideObject(),translations:l(this,_).toClientSideObject(this.route),segments:l(this,k).toClientSideObject(),formatters:l(this,v).toClientSideObject()};return`<script id="${l(me,Ct)}" type="application/json">${JSON.stringify(t)}</script>`},pe=new WeakSet,Kn=function(){let t={};for(let[r,n]of Object.entries(l(this,v).toObject()))t[r]=n.name;return JSON.stringify({environment:this.environment,route:this.route,locale:this.locale,locales:this.locales,primaryLocale:this.primaryLocale,secondaryLocales:this.secondaryLocales,fallbackLocale:this.fallbackLocale,isInitialized:this.isInitialized,"#redirection":l(this,D)instanceof Response?{url:l(this,D).url,status:l(this,D).status}:l(this,D),"#origin":l(this,lt),"#isGetStaticPaths":l(this,W),"#routePageCache":l(this,et),"#config":l(this,S).toObject(),"#translations":l(this,_).toObject(),"#segments":l(this,k).toObject(),"#formatters":t},null,"	")},y(ne,Ct,`__${L}__`);var Wn=ne;var E=new Wn;function ys(e,t){return e||(e=void 0),p(e)&&Object.keys(e).length===0&&(e=void 0),E.initialize(e,t),async(r,n)=>{if(r.url.pathname.startsWith("/_")||(E.isInitialized||await E.internals.waitInitialization(),import.meta.env.DEV&&await E.internals.reinitalize(e,t),E.internals.setPrivateProperties({isGetStaticPaths:!1,origin:r.url.origin}),E.route=r.url.pathname,E.internals.config.run!=="client+server"))return n();let s=await n(),i=E.internals.getAndClearRedirection();if(i)return i;if(!s.headers.get("content-type")?.includes("html")||s.bodyUsed)return s;let o=await s.text(),c=o.indexOf("</head>");return c>0&&(o=o.slice(0,c)+E.internals.toHtml()+o.slice(c)),new Response(o,{status:s.status,statusText:s.statusText,headers:s.headers})}}function ws(e){return async t=>(E.isInitialized||await E.internals.waitInitialization(),E.internals.setPrivateProperties({isGetStaticPaths:!0,locale:t.astroI18n?t.astroI18n.locale:E.primaryLocale,route:""}),e(t))}var al=E.t.bind(E),cl=E.l.bind(E);export{E as astroI18n,ws as createGetStaticPaths,es as defineAstroI18nConfig,cl as l,al as t,ys as useAstroI18n};
